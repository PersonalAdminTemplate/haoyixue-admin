(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-767a7b86"],{"3d19":function(e,t,a){},"45eb":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{margin:"-24px -24px 0px"}},[a("page-header",{attrs:{breadcrumb:e.breadcrumb,title:e.title,logo:e.logo,avatar:e.avatar}},[e._t("action",null,{slot:"action"}),e._t("headerContent",null,{slot:"content"}),!this.$slots.headerContent&&e.desc?a("div",{attrs:{slot:"content"},slot:"content"},[a("p",{staticStyle:{"font-size":"14px","line-height":"1.5",color:"rgba(0,0,0,.65)"}},[e._v(" "+e._s(e.desc)+" ")]),a("div",{staticClass:"link"},[e._l(e.linkList,(function(t,r){return[a("a",{key:r,attrs:{href:t.href}},[a("a-icon",{attrs:{type:t.icon}}),e._v(e._s(t.title))],1)]}))],2)]):e._e(),e._t("extra",null,{slot:"extra"})],2),a("div",{ref:"page",class:["page-content",e.layout]},[e._t("default")],2)],1)},i=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header"},[a("div",{class:["page-header-wide",e.layout]},[a("div",{staticClass:"breadcrumb"},[a("a-breadcrumb",e._l(e.breadcrumb,(function(t,r){return a("a-breadcrumb-item",{key:t.path},[a("span",0===r?[a("a",{attrs:{href:"#"}},[e._v(e._s(t.name))])]:[e._v(e._s(t.name))])])})),1)],1),a("div",{staticClass:"detail"},[e.avatar?a("div",{staticClass:"avatar"},[a("a-avatar",{attrs:{src:e.avatar}})],1):e._e(),a("div",{staticClass:"main"},[a("div",{staticClass:"row"},[e.logo?a("img",{staticClass:"logo",attrs:{src:e.logo}}):e._e(),e.title?a("h1",{staticClass:"title"},[e._v(e._s(e.title))]):e._e(),a("div",{staticClass:"action"},[e._t("action")],2)]),a("div",{staticClass:"row"},[this.$slots.content?a("div",{staticClass:"content"},[e._t("content")],2):e._e(),this.$slots.extra?a("div",{staticClass:"extra"},[e._t("extra")],2):e._e()])])])])])},o=[],s={name:"PageHeader",props:{title:{type:String,required:!1},breadcrumb:{type:Array,required:!1},logo:{type:String,required:!1},avatar:{type:String,required:!1}},computed:{layout:function(){return this.$store.state.setting.layout}}},l=s,c=(a("f010"),a("2877")),d=Object(c["a"])(l,n,o,!1,null,"ecb806fe",null),u=d.exports,h={name:"PageLayout",components:{PageHeader:u},props:{desc:{type:String,default:""},logo:{type:String},title:{type:String,default:""},avatar:{type:String},linkList:{type:Array},extraImage:{type:String}},data:function(){return{breadcrumb:[]}},computed:{layout:function(){return this.$store.state.setting.layout}},mounted:function(){this.getBreadcrumb()},updated:function(){this.getBreadcrumb()},methods:{getBreadcrumb:function(){this.breadcrumb=this.$route.matched}}},m=h,g=(a("d2e6"),Object(c["a"])(m,r,i,!1,null,"90fa1ce6",null));t["a"]=g.exports},"48a6":function(e,t,a){"use strict";var r=a("3d19"),i=a.n(r);i.a},"731e":function(e,t,a){},cb4e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-layout",{attrs:{desc:e.setting.desc,title:e.setting.title,linkList:e.setting.linkList,id:"user-manager"}},[a("div",{staticClass:"extraImg",attrs:{slot:"extra"},slot:"extra"},[a("img",{attrs:{src:e.setting.extraImage}})]),a("transition",{attrs:{name:"page-toggle"}},[a("keep-alive",[a("a-card",{staticClass:"content"},[a("a-form",{attrs:{form:e.searchForm.form,layout:"inline"},on:{submit:e.onSearch}},[a("a-row",{attrs:{type:"flex",align:"middle"}},[a("a-col",[a("a-form-item",{staticStyle:{width:"100%"},attrs:{label:"学校"}},[e.searchForm.schoolList.length>0?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["schoolCode",{initialValue:e.searchForm.schoolCode,rules:[{required:!0}]}],expression:"[\n                            'schoolCode',\n                            {\n                              initialValue: searchForm.schoolCode,\n                              rules: [{ required: true }]\n                            }\n                          ]"}],attrs:{placeholder:"请选择学校",showArrow:""},on:{change:e.onSchoolChange}},e._l(e.searchForm.schoolList,(function(t,r){return a("a-select-option",{key:r,attrs:{title:t.schoolName,value:t.schoolCode}},[e._v(" "+e._s(t.schoolName)+" ")])})),1):e._e()],1)],1),a("a-col",[a("a-form-item",{attrs:{label:"角色"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["role",{rules:[{required:!0}],initialValue:1}],expression:"[\n                    'role',\n                    {\n                      rules: [\n                        {\n                          required: true\n                        }\n                      ],\n                      initialValue: 1\n                    }\n                  ]"}],attrs:{name:"role"}},[a("a-radio",{attrs:{value:1}},[e._v("家长")]),a("a-radio",{attrs:{value:2}},[e._v("老师")]),a("a-radio",{attrs:{value:3}},[e._v("管理员")])],1)],1)],1),a("a-col",[a("a-form-item",{attrs:{label:"账户"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["account",{initialValue:""}],expression:"['account', { initialValue: '' }]"}],attrs:{oninput:"value=value.replace(/[^\\d]/g,'')"},on:{change:e.onAccountChange}})],1)],1),a("a-col",{staticStyle:{"flex-grow":"1"}},[a("a-form-item",[a("a-button",{attrs:{type:"primary","html-type":"submit",loading:e.searchForm.isLoading,disabled:e.searchForm.isLoading}},[e._v(" 查询 ")])],1)],1)],1)],1),a("a-table",{staticClass:"table",attrs:{pagination:e.table.pagination,columns:e.table.columns,dataSource:e.table.list,rowKey:"userId",bordered:"",loading:e.table.isLoading},on:{change:e.onPageChange},scopedSlots:e._u([e._l(["id","schoolCode","billName","description","role","createTime","updateTime"],(function(t){return{key:t,fn:function(r,i){return[a("div",{key:t},["role"===t?[1===i.role?[e._v(" 家长 ")]:e._e(),2===i.role?[e._v(" 老师 ")]:e._e(),3===i.role?[e._v(" 管理员 ")]:e._e()]:[e._v(e._s(r))]],2)]}}})),{key:"operation",fn:function(t,r){return[a("div",{staticClass:"editable-row-operations"},[a("span",[a("a",{on:{click:function(){return e.onEdit(r.userId)}}},[e._v("修改")])])])]}}],null,!0)})],1)],1)],1),a("a-modal",{staticClass:"change-modal",attrs:{visible:e.editForm.isVisible,title:"更新缴费项目",okText:"确定",cancelText:"取消",okButtonProps:{props:{loading:e.editForm.isLoading}}},on:{cancel:e.cancelEdit,ok:e.saveEdit}},[a("a-form",{attrs:{layout:"vertical",form:e.editForm.form}},[a("a-col",[a("a-form-item",{attrs:{wrapperCol:{span:12},label:"学校"}},[e.searchForm.schoolList.length>0?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["orgNo",{initialValue:e.searchForm.schoolCode,rules:[{required:!0}]}],expression:"[\n                      'orgNo',\n                      {\n                        initialValue: searchForm.schoolCode,\n                        rules: [{ required: true }]\n                      }\n                    ]"}],attrs:{placeholder:"请选择学校",showArrow:""}},e._l(e.searchForm.schoolList,(function(t,r){return a("a-select-option",{key:r,attrs:{title:t.schoolName,value:t.schoolCode}},[e._v(" "+e._s(t.schoolName)+" ")])})),1):e._e()],1)],1),a("a-col",[a("a-form-item",{attrs:{label:"角色"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["role",{rules:[{required:!0}],initialValue:e.editForm.data.role}],expression:"[\n                    'role',\n                    {\n                      rules: [\n                        {\n                          required: true\n                        }\n                      ],\n                      initialValue: editForm.data.role\n                    }\n                  ]"}],attrs:{name:"role"}},[a("a-radio",{attrs:{value:1}},[e._v("家长")]),a("a-radio",{attrs:{value:2}},[e._v("老师")]),a("a-radio",{attrs:{value:3}},[e._v("管理员")])],1)],1)],1),a("a-col",[a("a-form-item",{attrs:{label:"手机号码",wrapperCol:{span:12}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入手机号码"}],initialValue:e.editForm.data.phone}],expression:"['phone', {\n                      rules: [\n                        {\n                          required: true,\n                          message: '请输入手机号码'\n                        },\n                      ], initialValue: editForm.data.phone }]"}]})],1)],1)],1)],1)],1)},i=[],n=(a("4de4"),a("4160"),a("d3b7"),a("159b"),a("284c")),o=(a("96cf"),a("45eb")),s={name:"QueryList",components:{PageLayout:o["a"]},data:function(){return{setting:{title:"",desc:"",linkList:[],extraImage:""},searchForm:{form:this.$form.createForm(this,{name:"form"}),isLoading:!1,schoolList:[],schoolCode:"",account:""},editForm:{form:this.$form.createForm(this,{name:"changeForm"}),isLoading:!1,isVisible:!1,data:{}},table:{isLoading:!1,list:[],cacheList:[],pagination:{total:0,current:1,pageSize:10},columns:[{title:"ID",dataIndex:"userId",scopedSlots:{customRender:"userId"},align:"center"},{title:"昵称",dataIndex:"nickName",scopedSlots:{customRender:"nickName"},align:"center"},{title:"学校编码",dataIndex:"orgNo",scopedSlots:{customRender:"orgNo"},align:"center"},{title:"手机号码",dataIndex:"phone",scopedSlots:{customRender:"phone"},align:"center"},{title:"角色",dataIndex:"role",scopedSlots:{customRender:"role"},align:"center"},{title:"创建时间",dataIndex:"createTime",scopedSlots:{customRender:"createTime"},align:"center"},{title:"更新时间",dataIndex:"lastUpdateTime",scopedSlots:{customRender:"lastUpdateTime"},align:"center"},{title:"登录时间",dataIndex:"lastLoginTime",scopedSlots:{customRender:"lastLoginTime"},align:"center"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},align:"center"}]}}},methods:{onSearch:function(e){var t;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(e.preventDefault(),this.searchForm.isLoading=!0,this.table.pagination.current=1,!(null===(t=this.searchForm.account)||void 0===t?void 0:t.length)){a.next=8;break}return a.next=6,regeneratorRuntime.awrap(this.findUser());case 6:a.next=10;break;case 8:return a.next=10,regeneratorRuntime.awrap(this.getUsers());case 10:this.searchForm.isLoading=!1;case 11:case"end":return a.stop()}}),null,this)},onSchoolChange:function(e){this.searchForm.schoolCode=e},onAccountChange:function(e){var t=e.target.value;this.searchForm.account=t},onEdit:function(e){var t=Object(n["a"])(this.table.list),a=t.filter((function(t){return e===t.userId}))[0];a&&(this.editForm.data=a),this.editForm.form.resetFields(),this.editForm.isVisible=!0},saveEdit:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.updateUserInfo());case 2:e=t.sent,e&&(this.table.cacheList=[],this.table.pagination.current=1),this.getUsers();case 5:case"end":return t.stop()}}),null,this)},cancelEdit:function(){this.editForm.data={},this.editForm.isVisible=!1},onPageChange:function(e){this.table.pagination.current=e.current,this.getUsers()},updateUserInfo:function(){var e,t,a,r,i=this;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(e=this.$createElement,this.editForm.isLoading=!0,this.editForm.form.validateFields((function(e,r){a=e,t={userId:i.editForm.data.userId,phone:r.phone,role:r.role,orgNo:r.orgNo}})),!a){n.next=7;break}this.editForm.isLoading=!1,n.next=12;break;case 7:return n.next=9,regeneratorRuntime.awrap(this.$api.updateUserInfo(t).then((function(t){if(1===t.code)i.$message.success("修改成功"),r=!0;else{var a=t.msg||t.message||"无反馈信息";i.$error({title:"错误",content:e("div",[e("p",["修改用户信息失败"]),e("p",["错误提示: ",a])])})}})));case 9:this.editForm.data={},this.editForm.isLoading=!1,this.editForm.isVisible=!1;case 12:return n.abrupt("return",r);case 13:case"end":return n.stop()}}),null,this)},getUsers:function(){var e,t,a,r,i,n,o=this;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(e=this.$createElement,this.table.isLoading=!0,this.table.list=[],t={pageSize:this.table.pagination.pageSize,pageNum:this.table.pagination.current},a=!1,this.searchForm.form.validateFields((function(e,a){r=e,t.orgNo=a.schoolCode,t.role=a.role})),r){s.next=16;break}if(i=this.table.cacheList.filter((function(e){return e.pageNum===t.pageNum&&e.role===t.role&&e.orgNo===t.orgNo})),!(i.length>0)){s.next=13;break}this.table.list=i[0].list,this.table.pagination.total=i[0].total,s.next=16;break;case 13:return n={pageNum:t.pageNum,role:t.role,orgNo:t.orgNo},s.next=16,regeneratorRuntime.awrap(this.$api.getUsers(t).then((function(t){if(1===t.code&&t.data){var r,i,s;a=!0;var l=(null===t||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.pageData)||[];l.forEach((function(e,t){e.children&&delete e.children,e.key=t})),o.table.list=l,o.table.pagination.total=(null===t||void 0===t?void 0:null===(i=t.data)||void 0===i?void 0:i.dataTotal)||1,n.list=l,n.total=(null===t||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.dataTotal)||1,o.table.cacheList.push(n)}else{var c=t.msg||t.message||"无反馈信息";o.$error({title:"错误",content:e("div",[e("p",["获取用户列表失败"]),e("p",["错误提示: ",c])])})}})));case 16:return this.table.isLoading=!1,s.abrupt("return",a);case 18:case"end":return s.stop()}}),null,this)},findUser:function(){var e,t,a=this;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return e=this.$createElement,this.table.isLoading=!0,this.table.list=[],t={account:this.searchForm.account},r.next=6,regeneratorRuntime.awrap(this.$api.findUser(t).then((function(t){if(1===t.code){var r=(null===t||void 0===t?void 0:t.data)||null;(null===r||void 0===r?void 0:r.children)&&delete r.children,r&&a.table.list.push(r),a.table.pagination.total=1}else{var i=t.msg||t.message||"无反馈信息";a.$error({title:"错误",content:e("div",[e("p",["查询用户失败"]),e("p",["错误提示: ",i])])})}})));case 6:this.table.isLoading=!1;case 7:case"end":return r.stop()}}),null,this)},findSchoolList:function(){var e,t=this;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return e=this.$createElement,a.next=3,regeneratorRuntime.awrap(this.$api.findSchoolList().then((function(a){if(1===a.code&&a.data){var r;t.searchForm.schoolList=a.data,t.searchForm.schoolCode=(null===a||void 0===a?void 0:null===(r=a.data[0])||void 0===r?void 0:r.schoolCode)||""}else{t.searchForm.schoolList=[],t.searchForm.schoolCode="";var i=a.msg||a.message||"无反馈信息";t.$error({title:"错误",content:e("div",[e("p",["获取学校列表列表失败"]),e("p",["错误提示: ",i])])})}})));case 3:case"end":return a.stop()}}),null,this)},initData:function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.findSchoolList());case 2:this.getUsers();case 3:case"end":return e.stop()}}),null,this)}},mounted:function(){this.initData()}},l=s,c=(a("48a6"),a("edbc"),a("2877")),d=Object(c["a"])(l,r,i,!1,null,"00e1bcbc",null);t["default"]=d.exports},d2e6:function(e,t,a){"use strict";var r=a("e675"),i=a.n(r);i.a},e181:function(e,t,a){},e675:function(e,t,a){},edbc:function(e,t,a){"use strict";var r=a("731e"),i=a.n(r);i.a},f010:function(e,t,a){"use strict";var r=a("e181"),i=a.n(r);i.a}}]);
//# sourceMappingURL=chunk-767a7b86.421e263b.js.map